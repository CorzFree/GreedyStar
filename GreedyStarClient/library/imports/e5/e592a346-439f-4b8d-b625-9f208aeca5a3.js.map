{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\scripts\\Game/assets\\scripts\\Game\\MoveSync.js"],"names":["Const","require","MoveSync","onMoveSync","cacheSize","Math","floor","FPS","cacheQueue","isCacheing","timer","setInterval","length","pop","console","warn","log","bind","prototype","update","arrow","unshift","dispose","clearInterval","module","exports"],"mappings":";;;;;;AAAA,IAAIA,QAAQC,QAAQ,gBAAR,CAAZ;;AAGA,SAASC,QAAT,CAAkBC,UAAlB,EAA8B;AAC1B,SAAKC,SAAL,GAAiBC,KAAKC,KAAL,CAAWJ,SAASK,GAAT,GAAe,EAA1B,CAAjB;AACA,SAAKC,UAAL,GAAkB,EAAlB;AACA,SAAKC,UAAL,GAAkB,IAAlB;AACA,SAAKC,KAAL,GAAaC,YAAY,YAAY;AACjC,YAAI,KAAKH,UAAL,CAAgBI,MAAhB,GAAyB,CAA7B,EAAgC;AAC5B,gBAAI,CAAC,KAAKH,UAAV,EAAsB;AAClBN,2BAAW,KAAKK,UAAL,CAAgBK,GAAhB,EAAX;AACA,oBAAI,KAAKT,SAAL,GAAiB,CAAjB,IAAsB,KAAKI,UAAL,CAAgBI,MAAhB,GAAyB,KAAKR,SAAxD,EAAmE;AAC/D,2BAAO,KAAKI,UAAL,CAAgBI,MAAhB,GAA0B,KAAKR,SAAL,GAAiB,CAAlD,EAAsD;AAClDD,mCAAW,KAAKK,UAAL,CAAgBK,GAAhB,EAAX;AACAC,gCAAQC,IAAR,CAAa,kDAAkD,KAAKP,UAAL,CAAgBI,MAAlE,GAA2E,OAA3E,GAAqF,KAAKR,SAAvG;AACH;AACD,yBAAKK,UAAL,GAAkB,IAAlB;AACH;AACJ,aATD,MAUK;AACDK,wBAAQE,GAAR,CAAY,gCAAgC,KAAKR,UAAL,CAAgBI,MAA5D;AACH;AACJ,SAdD,MAeK;AACDE,oBAAQC,IAAR,CAAa,kCAAb;AACH;AACJ,KAnBwB,CAmBvBE,IAnBuB,CAmBlB,IAnBkB,CAAZ,EAmBC,OAAOf,SAASK,GAnBjB,CAAb;AAoBH;;AAEDL,SAASgB,SAAT,CAAmBC,MAAnB,GAA4B,UAAUC,KAAV,EAAiB;AACzC,SAAKZ,UAAL,CAAgBa,OAAhB,CAAwBD,KAAxB;AACA,QAAI,KAAKX,UAAL,IAAmB,KAAKD,UAAL,CAAgBI,MAAhB,IAA0B,KAAKR,SAAtD,EAAiE;AAC7D,aAAKK,UAAL,GAAkB,KAAlB;AACH;AACJ,CALD;;AAQAP,SAASgB,SAAT,CAAmBI,OAAnB,GAA6B,YAAY;AACrCC,kBAAc,KAAKb,KAAnB;AACH,CAFD;;AAIAR,SAASK,GAAT,GAAeP,MAAMO,GAArB;;AAEAiB,OAAOC,OAAP,GAAiBvB,QAAjB","file":"MoveSync.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\Game","sourcesContent":["let Const = require('../Const/Const');\r\n\r\n\r\nfunction MoveSync(onMoveSync) {\r\n    this.cacheSize = Math.floor(MoveSync.FPS / 10);\r\n    this.cacheQueue = [];\r\n    this.isCacheing = true;\r\n    this.timer = setInterval(function () {\r\n        if (this.cacheQueue.length > 0) {\r\n            if (!this.isCacheing) {\r\n                onMoveSync(this.cacheQueue.pop());\r\n                if (this.cacheSize > 0 && this.cacheQueue.length > this.cacheSize) {\r\n                    while (this.cacheQueue.length > (this.cacheSize - 1)) {\r\n                        onMoveSync(this.cacheQueue.pop());\r\n                        console.warn('[WARN] should jump frame ! the cacheQueue.len' + this.cacheQueue.length + '  >  ' + this.cacheSize);\r\n                    }\r\n                    this.isCacheing = true;\r\n                }\r\n            }\r\n            else {\r\n                console.log('[INFO] caching, queue.size:' + this.cacheQueue.length);\r\n            }\r\n        }\r\n        else {\r\n            console.warn('[WARN] the cache is not enough !');\r\n        }\r\n    }.bind(this), 1000 / MoveSync.FPS);\r\n}\r\n\r\nMoveSync.prototype.update = function (arrow) {\r\n    this.cacheQueue.unshift(arrow);\r\n    if (this.isCacheing && this.cacheQueue.length >= this.cacheSize) {\r\n        this.isCacheing = false;\r\n    }\r\n};\r\n\r\n\r\nMoveSync.prototype.dispose = function () {\r\n    clearInterval(this.timer);\r\n};\r\n\r\nMoveSync.FPS = Const.FPS;\r\n\r\nmodule.exports = MoveSync;\r\n\r\n\r\n\r\n\r\n"]}